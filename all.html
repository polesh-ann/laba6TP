<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Ü–µ–Ω—Ç—Ä - –ì–ª–∞–≤–Ω–∞—è</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <header class="header">
        <div class="logo">
            <i class="fas fa-dumbbell"></i>
            <h1>–°–ø–æ—Ä—Ç–¶–µ–Ω—Ç—Ä</h1>
        </div>
        <nav class="nav">
            <ul>
                <li><a href="#" class="active">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="#">–ó–∞–Ω—è—Ç–∏—è</a></li>
                <li><a href="#">–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã</a></li>
                <li><a href="#">–¢—Ä–µ–Ω–µ—Ä—ã</a></li>
                <li><a href="#">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a></li>
                <li><a href="#" class="btn-login">–í–æ–π—Ç–∏</a></li>
            </ul>
        </nav>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ -->
    <main class="main">
        <section class="hero">
            <h2>–ó–∞–Ω–∏–º–∞–π—Ç–µ—Å—å —Å–ø–æ—Ä—Ç–æ–º —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º</h2>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –∑–∞–ø–∏—à–∏—Ç–µ—Å—å –æ–Ω–ª–∞–π–Ω, –æ–ø–ª–∞—Ç–∏—Ç–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç ‚Äî –≤—Å—ë –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.</p>
            <button class="btn-primary" onclick="changeUser('admin')">–í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
            <button class="btn-primary" onclick="changeUser('user')" style="margin-left: 10px; background: #4caf50;">–í–æ–π—Ç–∏ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç</button>
        </section>

        <!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ –∑–∞–Ω—è—Ç–∏–π -->
        <section class="search-form">
            <h3>–ü–æ–∏—Å–∫ –∑–∞–Ω—è—Ç–∏–π</h3>
            <form>
                <select id="typeFilter">
                    <option value="">–í—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</option>
                    <option value="–π–æ–≥–∞">–ô–æ–≥–∞</option>
                    <option value="—Ñ–∏—Ç–Ω–µ—Å">–§–∏—Ç–Ω–µ—Å</option>
                    <option value="–ø–∏–ª–∞—Ç–µ—Å">–ü–∏–ª–∞—Ç–µ—Å</option>
                    <option value="–±–∞—Å—Å–µ–π–Ω">–ë–∞—Å—Å–µ–π–Ω</option>
                </select>
                <input type="date" id="dateFilter">
                <input type="time" id="timeFilter">
                <button type="button" onclick="applySearch()">–ù–∞–π—Ç–∏</button>
            </form>
            <p class="note">–ö–Ω–æ–ø–∫–∞ "–ù–∞–π—Ç–∏" –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π –Ω–∏–∂–µ.</p>
        </section>

        <!-- —Å–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç–∏–π -->
        <section class="lessons">
            <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è</h3>
            <div class="filters">
                <button class="btn-filter" onclick="filterLessons('all')">–í—Å–µ</button>
                <button class="btn-filter" onclick="filterLessons('–π–æ–≥–∞')">–ô–æ–≥–∞</button>
                <button class="btn-filter" onclick="filterLessons('—Ñ–∏—Ç–Ω–µ—Å')">–§–∏—Ç–Ω–µ—Å</button>
                <button class="btn-filter" onclick="filterLessons('–±–∞—Å—Å–µ–π–Ω')">–ë–∞—Å—Å–µ–π–Ω</button>
            </div>
            <div class="lesson-list" id="lessonList">
                <!-- –∑–¥–µ—Å—å –±—É–¥—É—Ç –∑–∞–Ω—è—Ç–∏—è -->
            </div>
            <div class="pagination">
                <button onclick="loadPage(1)">1</button>
                <button onclick="loadPage(2)">2</button>
                <button onclick="loadPage(3)">3</button>
                <button onclick="loadNextPage()">–î–∞–ª–µ–µ ‚Üí</button>
            </div>
        </section>

        <!-- —Ñ–æ—Ä–º–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <section class="admin-form">
            <h3>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
            <div class="admin-actions" id="adminActions">
                <!-- –∫–Ω–æ–ø–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∫–æ–≥–¥–∞ –≤–æ–π–¥—ë—Ç –∞–¥–º–∏–Ω -->
            </div>
            <p class="note">–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –≤–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</p>
        </section>

        <!-- —Ñ–æ—Ä–º–∞ –æ—à–∏–±–∫–∏ -->
        <section class="error-form">
            <h3>–û—à–∏–±–∫–∞</h3>
            <p> –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</p>
            <button class="btn-error" onclick="location.reload()">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </section>
    </main>

    <footer class="footer">
        <p>¬© 2025 –°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Ü–µ–Ω—Ç—Ä</p>
        <p>–ê–¥—Ä–µ—Å: –°–ö –ë–ì–£ (–æ–∫–æ–ª–æ –æ–±—â–∞–≥–∏)</p>
    </footer>

    <script>
        //–º–æ–¥–µ–ª—å
        class SportCenterModel {
            #lessons = [];

            constructor(lessons = []) {
                this.#lessons = lessons;
            }

            getLessons(skip = 0, top = 10, filterConfig = {}) {
                let filtered = [...this.#lessons];
                
                if (Object.keys(filterConfig).length > 0) {
                    filtered = filtered.filter(lesson => {
                        for (const key in filterConfig) {
                            if (lesson[key] !== filterConfig[key]) return false;
                        }
                        return true;
                    });
                }
                
                return filtered.slice(skip, skip + top);
            }

            getLesson(id) {
                return this.#lessons.find(l => l.id === id) || null;
            }

            addLesson(lesson) {
                if (!lesson.id) lesson.id = 'id_' + Date.now();
                if (!lesson.createdAt) lesson.createdAt = new Date();
                
                this.#lessons.push(lesson);
                console.log('–î–æ–±–∞–≤–ª–µ–Ω–æ:', lesson);
                return true;
            }

            editLesson(id, updates) {
                const index = this.#lessons.findIndex(l => l.id === id);
                if (index === -1) return false;
                
                this.#lessons[index] = {...this.#lessons[index], ...updates};
                return true;
            }

            removeLesson(id) {
                const initial = this.#lessons.length;
                this.#lessons = this.#lessons.filter(l => l.id !== id);
                return this.#lessons.length !== initial;
            }

            getTotalCount() {
                return this.#lessons.length;
            }

            getAllLessons() {
                return [...this.#lessons];
            }
        }

        // —Ç–µ—Å—Ç –¥–∞–Ω–Ω—ã–µ 
        const testLessons = [
            {
                id: '1',
                title: '–£—Ç—Ä–µ–Ω–Ω—è—è –π–æ–≥–∞',
                description: '–ô–æ–≥–∞ –¥–ª—è –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è',
                createdAt: new Date('2024-12-25T10:00:00'),
                author: '–ê–Ω–Ω–∞',
                type: '–π–æ–≥–∞',
                duration: 60,
                price: 500,
                location: '–°–ö –ë–ì–£'
            },
            {
                id: '2', 
                title: '–í–µ—á–µ—Ä–Ω–∏–π –±–∞—Å—Å–µ–π–Ω',
                description: '–ü–ª–∞–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã',
                createdAt: new Date('2024-12-25T18:00:00'),
                author: '–°–µ—Ä–≥–µ–π',
                type: '–±–∞—Å—Å–µ–π–Ω',
                duration: 90,
                price: 700,
                location: '–°–ö –ë–ì–£'
            },
            {
                id: '3',
                title: '–§–∏—Ç–Ω–µ—Å',
                description: '–°–∏–ª–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞',
                createdAt: new Date('2024-12-26T09:00:00'),
                author: '–ú–∞—Ä–∏—è',
                type: '—Ñ–∏—Ç–Ω–µ—Å',
                duration: 60,
                price: 450,
                location: '–°–ö –ë–ì–£'
            },
            {
                id: '4',
                title: '–ü–∏–ª–∞—Ç–µ—Å',
                description: '–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å',
                createdAt: new Date('2024-12-26T11:00:00'),
                author: '–û–ª—å–≥–∞',
                type: '–ø–∏–ª–∞—Ç–µ—Å',
                duration: 55,
                price: 400,
                location: '–°–ö –ë–ì–£'
            },
            {
                id: '5',
                title: '–ê—ç—Ä–æ–±–∏–∫–∞',
                description: '–¢–∞–Ω—Ü–µ–≤–∞–ª—å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞',
                createdAt: new Date('2024-12-26T17:00:00'),
                author: '–ï–ª–µ–Ω–∞',
                type: '–∞—ç—Ä–æ–±–∏–∫–∞',
                duration: 60,
                price: 350,
                location: '–°–ö –ë–ì–£'
            }
        ];

        // –≥–ª–æ–± –º–æ–¥–µ–ª—å
        const sportModel = new SportCenterModel(testLessons);
        let currentUser = null;

        // –§–£–ù–ö–¶–ò–ò

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function init() {
            renderLessons();
            updateUserDisplay();
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–∞–Ω—è—Ç–∏—è
        function renderLessons(filterType = 'all') {
            const container = document.getElementById('lessonList');
            if (!container) return;
            
            const filters = {
                'all': {},
                '–π–æ–≥–∞': { type: '–π–æ–≥–∞' },
                '—Ñ–∏—Ç–Ω–µ—Å': { type: '—Ñ–∏—Ç–Ω–µ—Å' },
                '–±–∞—Å—Å–µ–π–Ω': { type: '–±–∞—Å—Å–µ–π–Ω' },
                '–ø–∏–ª–∞—Ç–µ—Å': { type: '–ø–∏–ª–∞—Ç–µ—Å' }
            };
            
            const lessons = sportModel.getLessons(0, 20, filters[filterType] || {});
            
            container.innerHTML = '';
            
            if (lessons.length === 0) {
                container.innerHTML = '<p class="no-lessons">–ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π</p>';
                return;
            }
            
            lessons.forEach(lesson => {
                const card = document.createElement('div');
                card.className = 'lesson-card';
                card.innerHTML = `
                    <h4>${lesson.title}</h4>
                    <p><i class="fas fa-tag"></i> ${lesson.type}</p>
                    <p><i class="fas fa-clock"></i> ${lesson.duration} –º–∏–Ω</p>
                    <p><i class="fas fa-ruble-sign"></i> ${lesson.price} —Ä—É–±.</p>
                    <p>${lesson.description}</p>
                    <button class="btn-small" onclick="signUp('${lesson.id}')">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
                    ${currentUser?.role === 'admin' ? `
                        <button class="btn-small" style="background:orange" onclick="editLesson('${lesson.id}')">‚úèÔ∏è</button>
                        <button class="btn-small" style="background:red" onclick="deleteLesson('${lesson.id}')">üóëÔ∏è</button>
                    ` : ''}
                `;
                container.appendChild(card);
            });
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateUserDisplay() {
            const loginBtn = document.querySelector('.btn-login');
            const adminSection = document.getElementById('adminActions');
            
            if (currentUser) {
                if (loginBtn) {
                    loginBtn.textContent = currentUser.role === 'admin' ? '–ê–¥–º–∏–Ω' : currentUser.name;
                    loginBtn.style.background = '#4caf50';
                }
                
                if (currentUser.role === 'admin' && adminSection) {
                    adminSection.innerHTML = `
                        <button class="btn-admin" onclick="addNewLesson()">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ</button>
                        <button class="btn-admin">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</button>
                    `;
                }
            } else {
                if (loginBtn) {
                    loginBtn.textContent = '–í–æ–π—Ç–∏';
                    loginBtn.style.background = '';
                }
                if (adminSection) {
                    adminSection.innerHTML = '<p>–¢—Ä–µ–±—É–µ—Ç—Å—è –≤—Ö–æ–¥ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</p>';
                }
            }
        }


        // 1. –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        window.changeUser = function(role) {
            if (role === null) {
                currentUser = null;
            } else {
                currentUser = {
                    name: role === 'admin' ? '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '–ü–æ–ª–µ—à–∫–æ –ê–Ω–Ω–∞',
                    role: role
                };
            }
            updateUserDisplay();
            renderLessons();
            console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', currentUser?.role || '–Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
        };

        // 2. –î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ (–¥–ª—è –∞–¥–º–∏–Ω–∞)
        window.addNewLesson = function() {
            if (!currentUser || currentUser.role !== 'admin') {
                alert('–¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');
                return;
            }
            
            const title = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ:');
            const type = prompt('–¢–∏–ø (–π–æ–≥–∞/—Ñ–∏—Ç–Ω–µ—Å/–±–∞—Å—Å–µ–π–Ω):');
            
            if (title && type) {
                sportModel.addLesson({
                    title: title,
                    description: prompt('–û–ø–∏—Å–∞–Ω–∏–µ:', '–ù–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ'),
                    author: currentUser.name,
                    type: type,
                    duration: parseInt(prompt('–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω):', '60')) || 60,
                    price: parseInt(prompt('–¶–µ–Ω–∞:', '500')) || 500,
                    location: '–°–ö –ë–ì–£'
                });
                renderLessons();
            }
        };

        // 3. –£–¥–∞–ª–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ
        window.deleteLesson = function(id) {
            if (!currentUser || currentUser.role !== 'admin') {
                alert('–¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');
                return;
            }
            
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ?')) {
                sportModel.removeLesson(id);
                renderLessons();
            }
        };

        // 4. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏–µ
        window.editLesson = function(id) {
            if (!currentUser || currentUser.role !== 'admin') {
                alert('–¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');
                return;
            }
            
            const lesson = sportModel.getLesson(id);
            if (!lesson) return;
            
            const newTitle = prompt('–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:', lesson.title);
            if (newTitle) {
                sportModel.editLesson(id, {title: newTitle});
                renderLessons();
            }
        };

        // 5. –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
        window.signUp = function(id) {
            const lesson = sportModel.getLesson(id);
            if (lesson) {
                alert(`–í—ã –∑–∞–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞: ${lesson.title}`);
            }
        };

        // 6. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
        window.filterLessons = function(type) {
            renderLessons(type);
        };

        // 7. –ü–æ–∏—Å–∫
        window.applySearch = function() {
            const type = document.getElementById('typeFilter').value;
            filterLessons(type || 'all');
        };

        // 8. –ü–æ–ª—É—á–∏—Ç—å –º–æ–¥–µ–ª—å (–¥–ª—è –∫–æ–Ω—Å–æ–ª–∏)
        window.getModel = function() {
            return sportModel;
        };

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', init);

        //–≤ –∫–æ–Ω—Å–æ–ª—å
        console.log(' –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:');
        console.log('1. sportModel.getTotalCount() - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–Ω—è—Ç–∏–π');
        console.log('2. sportModel.getAllLessons() - –≤—Å–µ –∑–∞–Ω—è—Ç–∏—è');
        console.log('3. changeUser("admin") - –≤–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω');
        console.log('4. changeUser("user") - –≤–æ–π—Ç–∏ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å');
        console.log('5. changeUser(null) - –≤—ã–π—Ç–∏');
        console.log('6. addNewLesson() - –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ (–µ—Å–ª–∏ –≤—ã –∞–¥–º–∏–Ω)');
        console.log('7. filterLessons("–π–æ–≥–∞") - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –π–æ–≥—É');
    </script>
</body>
</html>